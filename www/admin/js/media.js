!function(){function e(e){$("#tree-view").treeview({data:e,enableLinks:!0,onNodeSelected:function(e,t){return $("#img-preview").attr("src",t.href),e.stopPropagation(),!1}})}function t(){}$(document).ready(function(){$.getJSON("/admin/media/tree",function(t){e(t)})}),t.prototype.uploadMedia=function(t){$("#users-dropdown").data("userid");var a=$(t),n=$("button[type='submit']",a),o=$("input[type='file']",a),r=o[0].files,d=$("input[name='name']",a),s=$("input[name='path']",a);n.html("Uploading...");var i=new FormData;i.append("name",d.val()),i.append("path",s.val());for(var p=0;p<r.length;p++){var u=r[p];i.append(o.attr("name"),u,u.name)}var c=new XMLHttpRequest;c.open("POST",a.attr("action"),!0),c.onreadystatechange=function(){4==c.readyState&&(200==c.status?(e(c.response),$("#success-message").text("upload done").parent(".alert").show()):$("#danger-message").text("upload failed").parent(".alert").show(),n.html("Upload"))},c.responseType="json",c.send(i)},t.prototype.renameMedia=function(){$("#users-dropdown").data("userid");var t="#tree-view .node-selected",a={method:"put",url:"/admin/media/rename",success:function(t){console.log(t),e(t)},error:function(e){console.log(e.responseText)},newValue:$("a",$(t)).text(),currValue:$("a",$(t)).attr("href")};InputFieldEdit.attach(t,a)},t.prototype.removeMedia=function(){$("#users-dropdown").data("userid");$.ajax({url:"/admin/media/remove",type:"put",dataType:"json",data:"currValue="+$("a",$("#tree-view .node-selected")).attr("href"),success:function(t){console.log(t),e(t),$("#img-preview").attr("src","https://placehold.it/350x150")},error:function(e){console.log(e.responseText)}})},window.MediaTab=new t}();