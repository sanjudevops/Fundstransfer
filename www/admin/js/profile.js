var ProfileEditor=Vue.component("profile-editor",{template:"#profile-editor",computed:{user:()=>store.state.user},methods:{updateProfile(e){let t=$(e.target);$.ajax({url:t.attr("action"),type:t.attr("method"),data:t.serialize(),dataType:"json",success:function(e){console.log(e),store.state.user=e.user,eventHub.$emit("alert",{type:"success",message:"update was successfull"})},error:function(e){console.log(e.responseText),eventHub.$emit("alert",{type:"warning",message:e.responseText})}})},uploadPhoto(e){let t=$(e.target);$.ajax({url:t.attr("action"),type:t.attr("method"),data:new FormData(e.target),contentType:!1,cache:!1,processData:!1,success:function(e){store.commit("updatePhotoUrl",e.src),console.log(e),eventHub.$emit("alert",{type:"success",message:"upload was successfull"})},error:function(e){console.log(e.responseText),eventHub.$emit("alert",{type:"warning",message:e.responseText})}})}}}),AlertFeedback=Vue.component("alert-feedback",{template:"#alert-feedback",data:()=>({alert:{message:"",type:"warning"}}),computed:{alertType(){switch(this.alert.type){case"warning":return"alert-warning";case"success":return"alert-success";default:return"alert-info"}}},methods:{closeAlert(){this.alert.message=""}},mounted(){let e=this;eventHub.$on("alert",function(t){e.alert=t,t.close&&setTimeout(function(){e.alert.message=""},t.close)})}});const eventHub=new Vue,store=new Vuex.Store({state:{user:{}},mutations:{updateProfile(e,t){e.user=t},updatePhotoUrl(e,t){e.user.photoUrl=t}}});var app=new Vue({el:"#app",mounted(){$.ajax({url:"/admin/profile",type:"get",dataType:"json",success:function(e){console.log(e),store.commit("updateProfile",e)},error:function(e){console.log(e.responseText),eventHub.$emit("alert",{type:"warning",message:e.responseText})}})}});